"use strict";var InstantClick=function(t,e){function n(t){var e=t.indexOf("#");return e<0?t:t.substr(0,e)}function i(t){for(;t&&"A"!=t.nodeName;)t=t.parentNode;return t}function r(t){do{if(!t.hasAttribute)break;if(t.hasAttribute("data-instant"))return!1;if(t.hasAttribute("data-no-instant"))return!0}while(t=t.parentNode);return!1}function a(t){do{if(!t.hasAttribute)break;if(t.hasAttribute("data-no-instant"))return!1;if(t.hasAttribute("data-instant"))return!0}while(t=t.parentNode);return!1}function o(t){var i=e.protocol+"//"+e.host;return!(t.target||t.hasAttribute("download")||0!=t.href.indexOf(i+"/")||t.href.indexOf("#")>-1&&n(t.href)==E||(C?!a(t):r(t)))}function s(t,e,n,i){for(var r=!1,a=0;a<X[t].length;a++)if("receive"==t){var o=X[t][a](e,n,i);o&&("body"in o&&(n=o.body),"title"in o&&(i=o.title),r=o)}else X[t][a](e,n,i);return r}function d(e,i,r,a){if(t.documentElement.replaceChild(i,t.body),r){history.pushState(null,null,r);var o=r.indexOf("#"),d=o>-1&&t.getElementById(r.substr(o+1)),l=0;if(d)for(;d.offsetParent;)l+=d.offsetTop,d=d.offsetParent;scrollTo(0,l),E=n(r)}else scrollTo(0,a);D&&t.title==e?t.title=e+String.fromCharCode(160):t.title=e,y(),q.done(),s("change",!1);var c=t.createEvent("HTMLEvents");c.initEvent("instantclick:newpage",{bubbles:!0,cancelable:!0}),dispatchEvent(c)}function l(){K=!1,P=!1}function c(t){return t.replace(/<noscript[\s\S]+<\/noscript>/gi,"")}function f(t){if(!(x>+new Date-500)){var e=i(t.target);e&&o(e)&&b(e.href)}}function u(t){if(!(x>+new Date-500)){var e=i(t.target);e&&o(e)&&(e.addEventListener("mouseout",m),H?(L=e.href,A=setTimeout(b,H)):b(e.href))}}function h(t){x=+new Date;var e=i(t.target);e&&o(e)&&(M?e.removeEventListener("mousedown",f):e.removeEventListener("mouseover",u),b(e.href))}function v(t){var e=i(t.target);e&&o(e)&&(t.which>1||t.metaKey||t.ctrlKey||(t.preventDefault(),g(e.href)))}function m(){if(A)return clearTimeout(A),void(A=!1);K&&!P&&(k.abort(),l())}function p(){if(!(k.readyState<4)&&0!=k.status){if(W.ready=+new Date-W.start,k.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var e=t.implementation.createHTMLDocument("");e.documentElement.innerHTML=c(k.responseText),S=e.title,z=e.body;var i=s("receive",N,z,S);i&&("body"in i&&(z=i.body),"title"in i&&(S=i.title));var r=n(N);B[r]={body:z,title:S,scrollY:r in B?B[r].scrollY:0};for(var a,o,l=e.head.children,f=0,u=l.length-1;u>=0;u--)if(a=l[u],a.hasAttribute("data-instant-track")){o=a.getAttribute("href")||a.getAttribute("src")||a.innerHTML;for(var h=R.length-1;h>=0;h--)R[h]==o&&f++}d!=R.length&&(I=!0)}else I=!0;P&&(P=!1,g(N))}}function y(e){if(t.body.addEventListener("touchstart",h,!0),M?t.body.addEventListener("mousedown",f,!0):t.body.addEventListener("mouseover",u,!0),t.body.addEventListener("click",v,!0),!e)for(var n=void 0,i=void 0,r=void 0,a=void 0,o=t.body.getElementsByTagName("script"),s=0,d=o.length;s<d;s++)n=o[s],n.hasAttribute("data-no-instant")||(i=t.createElement("script"),n.src&&(i.src=n.src),n.innerHTML&&(i.innerHTML=n.innerHTML),r=n.parentNode,a=n.nextSibling,r.removeChild(n),r.insertBefore(i,a))}function b(t){!M&&"display"in W&&+new Date-(W.start+W.display)<100||(A&&(clearTimeout(A),A=!1),t||(t=L),K&&(t==N||P)||(K=!0,P=!1,N=t,z=!1,I=!1,W={start:+new Date},s("fetch"),k.open("GET",t),k.send()))}function g(t){return"display"in W||(W.display=+new Date-W.start),A||!K?A&&N&&N!=t?void(e.href=t):(b(t),q.start(0,!0),s("wait"),void(P=!0)):P?void(e.href=t):I?void(e.href=N):z?(B[E].scrollY=window.scrollY,l(),void d(S,z,N)):(q.start(0,!0),s("wait"),void(P=!0))}function w(){if(!E){if(!G)return void s("change",!0);for(var i=arguments.length-1;i>=0;i--){var r=arguments[i];!0===r?C=!0:"mousedown"==r?M=!0:"number"==typeof r&&(H=r)}E=n(e.href),B[E]={body:t.body,title:t.title,scrollY:window.scrollY};for(var a,o,l=t.head.children,c=l.length-1;c>=0;c--)a=l[c],a.hasAttribute("data-instant-track")&&(o=a.getAttribute("href")||a.getAttribute("src")||a.innerHTML,R.push(o));k=new XMLHttpRequest,k.addEventListener("readystatechange",p),y(!0),q.init(),s("change",!0),addEventListener("popstate",function(){var t=n(e.href);if(t!=E){if(!(t in B))return void(e.href=e.href);B[E].scrollY=window.scrollY,E=t,d(B[t].title,B[t].body,!1,B[t].scrollY)}})}}function T(t,e){X[t].push(e)}var E,L,A,x,k,C,M,H,Y=navigator.userAgent,D=Y.indexOf(" CriOS/")>-1,O="createTouch"in t,B={},N=!1,S=!1,I=!1,z=!1,W={},K=!1,P=!1,R=[],X={fetch:[],receive:[],wait:[],change:[]},q=function(){function e(){d=t.createElement("div"),d.id="instantclick",l=t.createElement("div"),l.id="instantclick-bar",l.className="instantclick-bar",d.appendChild(l);var e=["Webkit","Moz","O"];if(!((c="transform")in l.style))for(var n=0;n<3;n++)e[n]+"Transform"in l.style&&(c=e[n]+"Transform");var i="transition";if(!(i in l.style))for(var n=0;n<3;n++)e[n]+"Transition"in l.style&&(i="-"+e[n].toLowerCase()+"-"+i);var r=t.createElement("style");r.innerHTML="#instantclick{position:"+(O?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+i+":opacity .25s .1s}.instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+i+":all .25s}",t.head.appendChild(r),O&&(s(),addEventListener("resize",s),addEventListener("scroll",s))}function n(e,n){f=e,t.getElementById(d.id)&&t.body.removeChild(d),d.style.opacity="1",t.getElementById(d.id)&&t.body.removeChild(d),a(),n&&setTimeout(i,0),clearTimeout(u),u=setTimeout(r,500)}function i(){f=10,a()}function r(){f+=1+2*Math.random(),f>=98?f=98:u=setTimeout(r,500),a()}function a(){l.style[c]="translate("+f+"%)",t.getElementById(d.id)||t.body.appendChild(d)}function o(){if(t.getElementById(d.id))return clearTimeout(u),f=100,a(),void(d.style.opacity="0");n(100==f?0:f),setTimeout(o,0)}function s(){d.style.left=pageXOffset+"px",d.style.width=innerWidth+"px",d.style.top=pageYOffset+"px";var t="orientation"in window&&90==Math.abs(orientation),e=innerWidth/screen[t?"height":"width"]*2;d.style[c]="scaleY("+e+")"}var d,l,c,f,u;return{init:e,start:n,done:o}}(),G="pushState"in history&&(!Y.match("Android")||Y.match("Chrome/"))&&"file:"!=e.protocol;return{supported:G,init:w,on:T}}(document,location);